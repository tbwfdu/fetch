<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title class="pageTitle"></title>
	<meta name="description" content="Workspace ONE Application Management Tool">

	<link rel="shortcut icon" href="/assets/fetch.png">

	<!-- Smart App Banner -->
	

	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	<link rel="stylesheet" href="/main.css">
</head>

<body class="subPageBody">
    <div class="headerBackground subPageHeaderBackground">
        <div class="subContainer subPageContainer">
        <header>
	<div class="logo">
		<div class="appIconShadow">
<!--			<svg width="0" height="0">
				<defs>
					<clipPath id="shape">
							<path id="shape" class="cls-1" d="M6181.23,233.709v-1.792c0-.5-0.02-1-0.02-1.523a24.257,24.257,0,0,0-.28-3.3,11.207,11.207,0,0,0-1.04-3.132,10.683,10.683,0,0,0-1.95-2.679,10.384,10.384,0,0,0-2.68-1.943,10.806,10.806,0,0,0-3.13-1.038,19.588,19.588,0,0,0-3.3-.285c-0.5-.017-1-0.017-1.52-0.017h-22.39c-0.51,0-1.01.017-1.53,0.017a24.041,24.041,0,0,0-3.3.285,11.009,11.009,0,0,0-3.13,1.038,10.491,10.491,0,0,0-4.62,4.622,10.893,10.893,0,0,0-1.04,3.132,19.2,19.2,0,0,0-.28,3.3c-0.02.5-.02,1-0.02,1.523v22.392c0,0.5.02,1,.02,1.524a24.257,24.257,0,0,0,.28,3.3,10.9,10.9,0,0,0,1.04,3.132,10.491,10.491,0,0,0,4.62,4.622,11.04,11.04,0,0,0,3.13,1.038,19.891,19.891,0,0,0,3.3.285c0.51,0.017,1.01.017,1.53,0.017h22.39c0.5,0,1-.017,1.52-0.017a24.221,24.221,0,0,0,3.3-.285,10.836,10.836,0,0,0,3.13-1.038,10.408,10.408,0,0,0,2.68-1.943,10.683,10.683,0,0,0,1.95-2.679,11.217,11.217,0,0,0,1.04-3.132,20.257,20.257,0,0,0,.28-3.3c0.02-.5.02-1,0.02-1.524v-20.6h0Z" transform="translate(-6131 -218)"/>
					</clipPath>
				</defs>
			</svg>-->
			
				<a href="../" target="_self"><img class="headerIcon" src="/assets/fetch.png"></a>
			
			<div class="divider"></div>
		</div>
		<p class="headerName">Fetch</p>
	</div>
	<nav class="scroll">
		<ul>
            
			
				
				<li><a href="/gettingstarted/" target="_self">Getting Started</a></li>
				
			
				
				<li><a href="/usage/" target="_self">Usage</a></li>
				
			
				
				<li><a href="/faq/" target="_self">FAQs</a></li>
				
			
			
		</ul>
	</nav>
<!--    <nav aria-label="Secondary navigation" class="dropdown-nav nav-layout">
        <ul>
            <li class="dropdown">
                <span class="dropbtn">More</span>
                <ul class="dropdown-menu">
                    <li><a href="/appinventory/">App Inventory</a></li>
                    <li><a href="/gettingstarted/">Getting Started</a></li>
                    <li><a href="/usage/">Usage</a></li>
                </ul>
            </li>
        </ul>
    </nav>-->
</header>
            <article class="page markdown-body">
                <h1 class="no_toc" id="frequently-asked-questions">Frequently Asked Questions</h1>

<h2 class="no_toc text-delta" id="page-contents">Page Contents</h2>

<ul id="markdown-toc">
  <li><a href="#how-often-is-the-fetch-database-updated" id="markdown-toc-how-often-is-the-fetch-database-updated">How often is the Fetch Database updated?</a></li>
  <li><a href="#what-operating-systems-does-fetch-support" id="markdown-toc-what-operating-systems-does-fetch-support">What Operating Systems does Fetch support?</a></li>
  <li><a href="#where-do-i-get-help-or-support-if-something-isnt-working" id="markdown-toc-where-do-i-get-help-or-support-if-something-isnt-working">Where do I get help or support if something isn‚Äôt working?</a></li>
  <li><a href="#what-is-the-source-of-application-information-in-the-fetch-database" id="markdown-toc-what-is-the-source-of-application-information-in-the-fetch-database">What is the source of Application Information in the Fetch Database?</a></li>
  <li><a href="#how-does-fetch-provide-how-to-install-when-to-call-install-complete--uninstall-commandscriteria" id="markdown-toc-how-does-fetch-provide-how-to-install-when-to-call-install-complete--uninstall-commandscriteria">How does Fetch provide <code class="language-plaintext highlighter-rouge">How To Install</code>, <code class="language-plaintext highlighter-rouge">When To Call Install Complete</code> &amp; <code class="language-plaintext highlighter-rouge">Uninstall</code> commands/criteria?</a></li>
</ul>

<h3 id="how-often-is-the-fetch-database-updated">How often is the Fetch Database updated?</h3>
<p>Fetch has a corresponding Web Service that automatically obtains the latest list of source applications and generates an updated database <strong>daily</strong> at approx. 00:05 UTC.
When querying for database updates in Fetch, the application communicates with this Web Service API to check for the updated database file and then replaces the local copy.</p>

<h3 id="what-operating-systems-does-fetch-support">What Operating Systems does Fetch support?</h3>
<p>The Fetch application itself has installers that will run on Windows 10/11 (x64 &amp; ARM64).</p>

<p>Applications that Fetch can <em>upload</em> to Workspace ONE is whatever version/format/architecture the Software Vendor provides in their manifests. As long as it is supported by Workspace ONE and provided in the correct format, Fetch will upload it to the Catalog.</p>

<h3 id="where-do-i-get-help-or-support-if-something-isnt-working">Where do I get help or support if something isn‚Äôt working?</h3>

<p><a href="https://github.com/tbwfdu/fetch/issues">Raise an issue here</a> and I will get back you as soon as I can üêõ.</p>

<h3 id="what-is-the-source-of-application-information-in-the-fetch-database">What is the source of Application Information in the Fetch Database?</h3>

<p>The Fetch database is populated by a separate microservice that downloads the entire package manifest list from the <strong>Official</strong> Microsoft Winget repository. These manifest files (over 140k) are parsed, correlated and imported into the database that Fetch uses.</p>

<p>Each day, the service pulls the latest manifests from the Microsoft Winget repository and generates a new database. This is then made available via a webhost that Fetch queries to get a copy of the updated database (if its newer than its current one).</p>

<p>Any application binaries, metadata, information etc. is the exact same information that the Winget command line tools use within Window. This is provided by the Software Vendor and vetted by Microsoft, however Fetch nor Microsoft grant any licenses, ownership or responsibility for the applications obtained or installed.</p>

<h3 id="how-does-fetch-provide-how-to-install-when-to-call-install-complete--uninstall-commandscriteria">How does Fetch provide <code class="language-plaintext highlighter-rouge">How To Install</code>, <code class="language-plaintext highlighter-rouge">When To Call Install Complete</code> &amp; <code class="language-plaintext highlighter-rouge">Uninstall</code> commands/criteria?</h3>

<p>If the application‚Äôs installer is a <strong>.msi file</strong>, this allows Fetch to use the built-in defaults of Workspace ONE UEM and how the Software Deployment Agent handles <strong>msiexec.exe</strong>.</p>

<p>For <strong>.exe files</strong>, Fetch uses the information provided in the Winget manifests to find the correct installation commands. It will attempt to find <em>‚ÄúSilent‚Äù</em> or <em>‚ÄúSilent with Progress‚Äù</em> switches and add these to the install commands in UEM.</p>

<p>To determine a <em>successful install</em> and <em>how to uninstall</em>, Fetch uploads (before the installer) two generic Powershell scripts: <strong>InstallSuccessCriteria.ps1</strong> &amp; <strong>Uninstall.ps1</strong></p>

<p>These scripts are used for determining when to call an application installed and to get the correct uninstallation commands.</p>

<p><strong>InstallSuccessCriteria.ps1</strong></p>

<p>This script runs and looks for an ‚ÄúUninstall‚Äù entry in the device‚Äôs registry for the application. Because we know the name of the Application, the name the Application in Add/Remove programs and the version as it is in the Winget manifest, we pass these as variables to the script and it returns a 0 (found) or 1 (not found) exit code.</p>

<div class="language-ps highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="nf">#</span> 
  <span class="nf">.DESCRIPTION</span>
    <span class="nf">Takes</span> <span class="nf">two</span> <span class="nf">input</span> <span class="nf">variables</span> <span class="kr">and</span> <span class="nf">then</span> <span class="nf">searches</span> <span class="nf">the</span> <span class="nf">registry</span> <span class="nf">to</span> <span class="nf">report</span> <span class="kr">if</span> <span class="nf">an</span> <span class="nf">Uninstall</span> <span class="nf">entry</span> <span class="nf">exists</span> <span class="kr">for</span> <span class="nf">the</span> <span class="nf">Application</span> <span class="nf">name</span> <span class="kr">and</span> <span class="nf">Version.</span> <span class="nf">Then</span> <span class="nf">uses</span> <span class="nf">the</span> <span class="nf">uninstallcommand</span> <span class="nf">to</span> <span class="nf">remove</span> <span class="nf">the</span> <span class="nf">application.</span>
  <span class="nf">.EXAMPLE</span>
    <span class="nf">.\Uninstall.ps1</span> <span class="nf">"7-Zip"</span> <span class="nf">"24.07"</span>
  <span class="nf">.PARAMETER</span> <span class="mf">0</span>
    <span class="nf">Application</span> <span class="nf">Name</span> <span class="nf">used</span> <span class="nf">to</span> <span class="nf">do</span> <span class="nf">a</span> <span class="nf">lookup</span> <span class="nf">using</span> <span class="nf">a</span> <span class="nf">"-LIKE"</span> <span class="nf">function</span> <span class="nf">to</span> <span class="nf">remove</span> <span class="nf">the</span> <span class="nf">need</span> <span class="kr">for</span> <span class="nf">an</span> <span class="nf">exact</span> <span class="nf">match</span> <span class="nf">on</span> <span class="nf">the</span> <span class="nf">name.</span>
  <span class="nf">.PARAMETER</span> <span class="mf">1</span>
    <span class="nf">The</span> <span class="nf">Application</span> <span class="nf">Version</span> <span class="nf">to</span> <span class="nf">ensure</span> <span class="nf">we</span> <span class="nf">are</span> <span class="nf">only</span> <span class="nf">looking</span> <span class="kr">for</span> <span class="nf">the</span> <span class="nf">exact</span> <span class="nf">version</span> <span class="nf">in</span> <span class="nf">case</span> <span class="nf">the</span> <span class="nf">application</span> <span class="nf">allows</span> <span class="nf">multiple</span> <span class="nf">versions</span> <span class="nf">to</span> <span class="nf">be</span> <span class="nf">installed.</span>
  <span class="nf">.NOTES</span> 
    <span class="nf">Created:</span>   	    <span class="nf">July,</span> <span class="mf">2024</span>
    <span class="nf">Created</span> <span class="nf">by:</span>	    <span class="nf">Pete</span> <span class="nf">Lindley,</span> <span class="nf">@tbwfdu</span>
<span class="nf">#</span><span class="p">&gt;</span>

<span class="nf">param</span><span class="s">(
    [Parameter(Position=0,mandatory=$true)]
    [string] $DisplayName,
    [Parameter(Position=1,mandatory=$true)]
    [string] $DisplayVersion
)</span>

<span class="nf">$UninstallString</span> <span class="nf">=</span> <span class="nf">Get-ItemProperty</span> <span class="nf">-Path</span> <span class="nf">HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*</span> <span class="nf">|</span> <span class="nf">Where-Object</span> <span class="p">{</span><span class="s">($_.DisplayName -Like "$DisplayName*")</span> <span class="nf">-and</span> <span class="s">($_.DisplayVersion -eq $DisplayVersion)</span><span class="p">}</span> <span class="nf">|</span> <span class="nf">Select-Object</span> <span class="nf">-ExpandProperty</span> <span class="nf">"UninstallString";</span>
<span class="nf">$QuietUninstallString</span> <span class="nf">=</span> <span class="nf">Get-ItemProperty</span> <span class="nf">-Path</span> <span class="nf">HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*</span> <span class="nf">|</span> <span class="nf">Where-Object</span> <span class="p">{</span><span class="s">($_.DisplayName -Like "$DisplayName*")</span> <span class="nf">-and</span> <span class="s">($_.DisplayVersion -eq $DisplayVersion)</span><span class="p">}</span> <span class="nf">|</span> <span class="nf">Select-Object</span> <span class="nf">-ExpandProperty</span> <span class="nf">"QuietUninstallString";</span>

<span class="kr">if</span><span class="s">($null -ne $QuietUninstallString)</span>
<span class="p">{</span>
    <span class="nf">Invoke-Expression</span> <span class="nf">"&amp;</span> <span class="nf">$QuietUninstallString"</span>
<span class="p">}</span>

<span class="nf">elseif</span><span class="s">($null -ne $UninstallString)</span>
<span class="p">{</span>
    <span class="nf">Invoke-Expression</span> <span class="nf">"&amp;</span> <span class="nf">$UninstallString"</span>
<span class="p">}</span>

</code></pre></div></div>

<p><strong>When To Call Installation Complete</strong> <em>example</em>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell.exe -ExecutionPolicy Bypass -File InstallSuccessCriteria.ps1 "VMware Horizon Client" "8.5.0.26981"
</code></pre></div></div>

<p><strong>Uninstall.ps1</strong>
Each application that gets installed in Windows creates a registry key with it‚Äôs uninstall command so that when a user uses Add/Remove Programs it is able to uninstall the application correctly. The uninstall script provided by Fetch firstly searches the registry (using the same parameters above for detection), obtains the uninstall command from the registry, and then runs the command to uninstall the application.</p>
<div class="language-ps highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="nf">#</span> 
  <span class="nf">.DESCRIPTION</span>
    <span class="nf">Takes</span> <span class="nf">two</span> <span class="nf">input</span> <span class="nf">variables</span> <span class="kr">and</span> <span class="nf">then</span> <span class="nf">searches</span> <span class="nf">the</span> <span class="nf">registry</span> <span class="nf">to</span> <span class="nf">report</span> <span class="kr">if</span> <span class="nf">an</span> <span class="nf">Uninstall</span> <span class="nf">entry</span> <span class="nf">exists</span> <span class="kr">for</span> <span class="nf">the</span> <span class="nf">Application</span> <span class="nf">name</span> <span class="kr">and</span> <span class="nf">Version.</span> <span class="nf">Then</span> <span class="nf">uses</span> <span class="nf">the</span> <span class="nf">uninstallcommand</span> <span class="nf">to</span> <span class="nf">remove</span> <span class="nf">the</span> <span class="nf">application.</span>
  <span class="nf">.EXAMPLE</span>
    <span class="nf">.\Uninstall.ps1</span> <span class="nf">"7-Zip"</span> <span class="nf">"24.07"</span>
  <span class="nf">.PARAMETER</span> <span class="mf">0</span>
    <span class="nf">Application</span> <span class="nf">Name</span> <span class="nf">used</span> <span class="nf">to</span> <span class="nf">do</span> <span class="nf">a</span> <span class="nf">lookup</span> <span class="nf">using</span> <span class="nf">a</span> <span class="nf">"-LIKE"</span> <span class="nf">function</span> <span class="nf">to</span> <span class="nf">remove</span> <span class="nf">the</span> <span class="nf">need</span> <span class="kr">for</span> <span class="nf">an</span> <span class="nf">exact</span> <span class="nf">match</span> <span class="nf">on</span> <span class="nf">the</span> <span class="nf">name.</span>
  <span class="nf">.PARAMETER</span> <span class="mf">1</span>
    <span class="nf">The</span> <span class="nf">Application</span> <span class="nf">Version</span> <span class="nf">to</span> <span class="nf">ensure</span> <span class="nf">we</span> <span class="nf">are</span> <span class="nf">only</span> <span class="nf">looking</span> <span class="kr">for</span> <span class="nf">the</span> <span class="nf">exact</span> <span class="nf">version</span> <span class="nf">in</span> <span class="nf">case</span> <span class="nf">the</span> <span class="nf">application</span> <span class="nf">allows</span> <span class="nf">multiple</span> <span class="nf">versions</span> <span class="nf">to</span> <span class="nf">be</span> <span class="nf">installed.</span>
  <span class="nf">.NOTES</span> 
    <span class="nf">Created:</span>   	    <span class="nf">July,</span> <span class="mf">2024</span>
    <span class="nf">Created</span> <span class="nf">by:</span>	    <span class="nf">Pete</span> <span class="nf">Lindley,</span> <span class="nf">@tbwfdu</span>
    <span class="nf">Current</span> <span class="nf">Version:</span> <span class="mf">0.3</span>
    <span class="nf">VERSION</span> <span class="nf">HISTORY</span>
    <span class="mf">0.3</span> <span class="nf">-</span> <span class="nf">Made</span> <span class="nf">changes</span> <span class="nf">to</span> <span class="nf">the</span> <span class="nf">order</span> <span class="nf">of</span> <span class="nf">detect</span> <span class="kr">and</span> <span class="nf">how</span> <span class="nf">it</span> <span class="nf">runs.</span> <span class="nf">No</span> <span class="nb">exit</span> <span class="nf">codes</span> <span class="kr">for</span> <span class="nf">success</span> <span class="nf">seems</span> <span class="nf">to</span> <span class="nf">work.</span>
    <span class="mf">0.2</span> <span class="nf">-</span> <span class="nf">Added</span> <span class="nf">the</span> <span class="nf">capability</span> <span class="nf">that</span> <span class="nf">it</span> <span class="nf">looks</span> <span class="nf">at</span> <span class="nf">other</span> <span class="nf">registry</span> <span class="nf">locations</span> <span class="kr">for</span> <span class="nf">installers</span> <span class="nf">that</span> <span class="nf">don't</span> <span class="nf">use</span> <span class="nf">standard</span> <span class="nf">installers</span><span class="nv">/methods</span> <span class="kr">or</span> <span class="nf">when</span> <span class="nf">installing</span> <span class="nf">32-bit</span> <span class="nf">on</span> <span class="nf">64-bit</span> <span class="nf">Windows.</span>
    <span class="mf">0.1</span> <span class="nf">-</span> <span class="nf">This</span> <span class="nf">looks</span> <span class="nf">at</span> <span class="nf">the</span> <span class="nf">normal</span> <span class="nf">Uninstall</span> <span class="nf">keys</span> <span class="nf">in</span> <span class="nf">the</span> <span class="nf">registry</span>

<span class="nf">#</span><span class="p">&gt;</span>

<span class="nf">param</span><span class="s">(
    [Parameter(Position=0,mandatory=$true)]
    [string] $DisplayName,
    [Parameter(Position=1,mandatory=$true)]
    [string] $DisplayVersion
)</span>

<span class="nf">$UninstallString</span> <span class="nf">=</span> <span class="nf">Get-ItemProperty</span> <span class="nf">-Path</span> <span class="nf">HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*</span> <span class="nf">|</span> <span class="nf">Where-Object</span> <span class="p">{</span><span class="s">($_.DisplayName -Like "$DisplayName*")</span> <span class="nf">-and</span> <span class="s">($_.DisplayVersion -eq $DisplayVersion)</span><span class="p">}</span> <span class="nf">|</span> <span class="nf">Select-Object</span> <span class="nf">-ExpandProperty</span> <span class="nf">"UninstallString";</span>

<span class="nf">$QuietUninstallString</span> <span class="nf">=</span> <span class="nf">Get-ItemProperty</span> <span class="nf">-Path</span> <span class="nf">HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*</span> <span class="nf">|</span> <span class="nf">Where-Object</span> <span class="p">{</span><span class="s">($_.DisplayName -Like "$DisplayName*")</span> <span class="nf">-and</span> <span class="s">($_.DisplayVersion -eq $DisplayVersion)</span><span class="p">}</span> <span class="nf">|</span> <span class="nf">Select-Object</span> <span class="nf">-ExpandProperty</span> <span class="nf">"QuietUninstallString";</span>

<span class="nf">$UninstallString_WOW6432Node</span> <span class="nf">=</span> <span class="nf">Get-ItemProperty</span> <span class="nf">-Path</span> <span class="nf">HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*</span> <span class="nf">|</span> <span class="nf">Where-Object</span> <span class="p">{</span><span class="s">($_.DisplayName -Like "$DisplayName*")</span> <span class="nf">-and</span> <span class="s">($_.DisplayVersion -eq $DisplayVersion)</span><span class="p">}</span> <span class="nf">|</span> <span class="nf">Select-Object</span> <span class="nf">-ExpandProperty</span> <span class="nf">"UninstallString";</span>

<span class="nf">$QuietUninstallString_WOW6432Node</span> <span class="nf">=</span> <span class="nf">Get-ItemProperty</span> <span class="nf">-Path</span> <span class="nf">HKLM:\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*</span> <span class="nf">|</span> <span class="nf">Where-Object</span> <span class="p">{</span><span class="s">($_.DisplayName -Like "$DisplayName*")</span> <span class="nf">-and</span> <span class="s">($_.DisplayVersion -eq $DisplayVersion)</span><span class="p">}</span> <span class="nf">|</span> <span class="nf">Select-Object</span> <span class="nf">-ExpandProperty</span> <span class="nf">"QuietUninstallString";</span>


<span class="kr">if</span><span class="s">($null -ne $QuietUninstallString)</span>
<span class="p">{</span>
    <span class="nf">Invoke-Expression</span> <span class="nf">"&amp;</span> <span class="nf">$QuietUninstallString"</span>
<span class="p">}</span>

<span class="nf">elseif</span><span class="s">($null -ne $UninstallString)</span>
<span class="p">{</span>
    <span class="nf">Invoke-Expression</span> <span class="nf">"&amp;</span> <span class="nf">$UninstallString";</span>

<span class="p">}</span>

<span class="nf">elseif</span><span class="s">($null -ne $QuietUninstallString_WOW6432Node)</span>
<span class="p">{</span>
    <span class="nf">Invoke-Expression</span> <span class="nf">"&amp;</span> <span class="nf">$QuietUninstallString_WOW6432Node";</span>
<span class="p">}</span>

<span class="nf">elseif</span><span class="s">($null -ne $UninstallString_WOW6432Node)</span>
<span class="p">{</span>
    <span class="nf">Invoke-Expression</span> <span class="nf">"&amp;</span> <span class="nf">$UninstallString_WOW6432Node";</span>
<span class="p">}</span>

<span class="nf">else</span> <span class="p">{</span>
  <span class="nb">exit</span> <span class="nf">0;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>How To Uninstall</strong> <em>example</em>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell.exe -ExecutionPolicy Bypass -File Uninstall.ps1 "7-Zip" "19.00.00.0"
</code></pre></div></div>

<blockquote class="note-title">
  <p>Note</p>

  <p>These Powershell files are embedded into the Application. Fetch automatically populates the App Name/Version variables so the commands for verifying a successful install/uninstall (the parameters of the script) so these are shown here for completeness.</p>
</blockquote>

            </article>
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>


    </div>
</body>

</html>